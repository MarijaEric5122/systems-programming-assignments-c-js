<!doctypehtml><html lang=sr><head><meta charset=utf-8><title>Zadatak 2</title></head><body><h3>Izaberite sliku i podesite osvetljenje</h3><input id=imgInput type=file><br><br><label>Osvetljenje (-50 do 50): <input id=paramRange type=range max=50 min=-50 step=1 value=0> <span id=paramLabel>0</span></label> <button disabled id=btnPrimeni>Primeni filter</button><div style=display:flex;gap:20px><div><h4>Original</h4><canvas id=canvasOriginal></canvas></div><div><h4>Filter (promenjeno osvetljenje)</h4><canvas id=canvasFiltered></canvas></div></div><script>var Module={onRuntimeInitialized:function(){document.getElementById("btnPrimeni").disabled=!1}}</script><script async src=brightness.js></script><script>const imgInput=document.getElementById("imgInput"),paramRange=document.getElementById("paramRange"),paramLabel=document.getElementById("paramLabel"),btn=document.getElementById("btnPrimeni"),canvasOrg=document.getElementById("canvasOriginal"),canvasFil=document.getElementById("canvasFiltered"),ctxOrg=canvasOrg.getContext("2d"),ctxFil=canvasFil.getContext("2d");let imgWidth=0,imgHeight=0;paramRange.addEventListener("input",(function(){paramLabel.textContent=paramRange.value})),imgInput.addEventListener("change",(function(e){const t=e.target.files[0];if(!t)return;const a=new Image;a.onload=function(){imgWidth=a.width,imgHeight=a.height,canvasOrg.width=imgWidth,canvasOrg.height=imgHeight,canvasFil.width=imgWidth,canvasFil.height=imgHeight,ctxOrg.drawImage(a,0,0),ctxFil.drawImage(a,0,0)},a.src=URL.createObjectURL(t)})),btn.addEventListener("click",(function(){if(!imgWidth||!imgHeight)return void alert("Prvo izaberite sliku.");const e=parseInt(paramRange.value,10)||0,t=ctxOrg.getImageData(0,0,imgWidth,imgHeight),a=t.data,n=a.length,i=Module._malloc(n);Module.HEAPU8.set(a,i),Module.ccall("change_brightness",null,["number","number","number"],[i,n,e]);const g=Module.HEAPU8.subarray(i,i+n);t.data.set(g),ctxFil.putImageData(t,0,0),Module._free(i)}))</script></body></html>